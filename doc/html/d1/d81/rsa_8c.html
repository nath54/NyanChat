<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NyanChat: src/rsa.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NyanChat
   </div>
   <div id="projectbrief">JAYAT Adrien, JACQUET Ys√©e and CERISARA Nathan</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d1/d81/rsa_8c.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">rsa.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;openssl/err.h&gt;</code><br />
<code>#include &lt;openssl/pem.h&gt;</code><br />
<code>#include &lt;openssl/evp.h&gt;</code><br />
<code>#include &lt;openssl/rsa.h&gt;</code><br />
<code>#include &lt;openssl/bn.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adc80aa5d11c6ed8555d76e0a90ef8070" id="r_adc80aa5d11c6ed8555d76e0a90ef8070"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc80aa5d11c6ed8555d76e0a90ef8070">generate_keypair</a> (const char *private_key_file, const char *public_key_file, int key_size)</td></tr>
<tr class="separator:adc80aa5d11c6ed8555d76e0a90ef8070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e845b6ac2572906fcb58f344136e30e" id="r_a5e845b6ac2572906fcb58f344136e30e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e845b6ac2572906fcb58f344136e30e">encrypt_message</a> (const char *message, size_t message_len, const char *public_key_file, unsigned char **encrypted_message, size_t *encrypted_len)</td></tr>
<tr class="separator:a5e845b6ac2572906fcb58f344136e30e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f6cd92ae72bd8b71c89354051706f70" id="r_a2f6cd92ae72bd8b71c89354051706f70"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f6cd92ae72bd8b71c89354051706f70">decrypt_message</a> (const unsigned char *encrypted_message, size_t encrypted_len, const char *private_key_file, unsigned char **decrypted_message, size_t *decrypted_len)</td></tr>
<tr class="separator:a2f6cd92ae72bd8b71c89354051706f70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2098d9ed172acae29ce9c0151eae272f" id="r_a2098d9ed172acae29ce9c0151eae272f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2098d9ed172acae29ce9c0151eae272f">load_rsa_key</a> (char *rsa_key, char *dest, size_t t_max, uint32_t *t_read)</td></tr>
<tr class="separator:a2098d9ed172acae29ce9c0151eae272f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="adc80aa5d11c6ed8555d76e0a90ef8070" name="adc80aa5d11c6ed8555d76e0a90ef8070"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc80aa5d11c6ed8555d76e0a90ef8070">&#9670;&#160;</a></span>generate_keypair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int generate_keypair </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>private_key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>public_key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>key_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates an RSA key pair and saves the private and public keys to the specified files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">private_key_file</td><td>The file to save the private key. </td></tr>
    <tr><td class="paramname">public_key_file</td><td>The file to save the public key. </td></tr>
    <tr><td class="paramname">key_size</td><td>The size of the RSA key in bits.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success, 0 on failure.</dd></dl>
<p>This function generates an RSA key pair using the OpenSSL EVP API. It creates an EVP_PKEY context, sets the RSA key size, and generates the key pair. The keys are then written to the specified files in PEM format. All resources are cleaned up before returning.</p>
<p>Example use:</p>
<blockquote class="doxtable">
<p>&zwj;generate_keypair("private.pem", "public.pem", 2048); </p>
</blockquote>

</div>
</div>
<a id="a5e845b6ac2572906fcb58f344136e30e" name="a5e845b6ac2572906fcb58f344136e30e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e845b6ac2572906fcb58f344136e30e">&#9670;&#160;</a></span>encrypt_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int encrypt_message </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>public_key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>encrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>encrypted_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encrypts a message using a public key from the specified file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>The message to encrypt. </td></tr>
    <tr><td class="paramname">message_len</td><td>The length of the message. </td></tr>
    <tr><td class="paramname">public_key_file</td><td>The file containing the public key in PEM format. </td></tr>
    <tr><td class="paramname">encrypted_message</td><td>A pointer to hold the encrypted message. The caller must free this buffer. </td></tr>
    <tr><td class="paramname">encrypted_len</td><td>A pointer to hold the length of the encrypted message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure.</dd></dl>
<p>This function reads the public key from a PEM file, initializes an EVP_PKEY context for encryption, and performs the encryption using RSA with PKCS#1 v1.5 padding. The encrypted message and its length are returned through the output parameters. </p>

</div>
</div>
<a id="a2f6cd92ae72bd8b71c89354051706f70" name="a2f6cd92ae72bd8b71c89354051706f70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f6cd92ae72bd8b71c89354051706f70">&#9670;&#160;</a></span>decrypt_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int decrypt_message </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>encrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>encrypted_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>private_key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>decrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>decrypted_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypts a message using a private key from the specified file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encrypted_message</td><td>The encrypted message to decrypt. </td></tr>
    <tr><td class="paramname">encrypted_len</td><td>The length of the encrypted message. </td></tr>
    <tr><td class="paramname">private_key_file</td><td>The file containing the private key in PEM format. </td></tr>
    <tr><td class="paramname">decrypted_message</td><td>A pointer to hold the decrypted message. The caller must free this buffer. </td></tr>
    <tr><td class="paramname">decrypted_len</td><td>A pointer to hold the length of the decrypted message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure.</dd></dl>
<p>This function reads the private key from a PEM file, initializes an EVP_PKEY context for decryption, and performs the decryption using RSA with PKCS#1 v1.5 padding. The decrypted message and its length are returned through the output parameters. </p>

</div>
</div>
<a id="a2098d9ed172acae29ce9c0151eae272f" name="a2098d9ed172acae29ce9c0151eae272f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2098d9ed172acae29ce9c0151eae272f">&#9670;&#160;</a></span>load_rsa_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load_rsa_key </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>rsa_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>t_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>t_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../d1/d81/rsa_8c.html">rsa.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
